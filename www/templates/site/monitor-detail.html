<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>监控画面</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <!--<script type="text/javascript" src="../../cordova.js"></script>-->
    <!--<script type="text/javascript" src="../../cordova_plugins.js"></script>-->
    <!--<link rel="stylesheet" href="../../components/mui/css/mui.min.css">-->
    <!--<link rel="stylesheet" href="../../css/my.css">-->
    <!--<script type="text/javascript" src="../../components/libs/jquery-2.1.4.min.js"></script>-->
    <style>
        html,body,body>div{
            height: 100%;
            width: 100%;
            padding: 0;
            margin: 0;
            background-color: #fff;
        }
        iframe{
            border: 0;
            width: 100%;
            height: 100%;
            position: fixed;
            top:0;
            left: 0;
        }
        .pinch-zoom-container, .pinch-zoom{
            width: 100%;
            height: 100%;
            -webkit-user-drag: none;
        }
    </style>
</head>
<body>
<!--<header class="mui-bar mui-bar-transparent" style="z-index: 1000;">-->
    <!--<a class="mui-icon  mui-icon-left-nav mui-pull-left text-white" onclick="pageBack()" style="color: #fff;"></a>-->
<!--</header>-->
<div style="position:relative;width: 100%;height: 100%;overflow: hidden;">
    <div id="targetObj" style="width: 100%;height: 100%;position:relative;transform-origin:center;"  >
        <div style="width: 100%;height: 100%;">
            <div style="width: 100%;height: 100%;">
                <iframe id="iframe"></iframe>
            </div>
        </div>
    </div>
    <div style="position: fixed;right: 6px;top: 6px;width: 36px;height: 36px;padding: 6px;" onclick="back()">
        <div style="background-color: rgba(232, 232, 232, 0.65);opacity: 0.7;width: 24px;height: 24px;">
            <img src="/img/light/64X64/close.png" style="width: 16px;height: 16px;margin: 4px 0 0 4px;display: inline-block;">
        </div>
    </div>
</div>
    <!--<script src="../../components/fastclick-master/lib/fastclick.js"></script>-->
    <!--<script src="../../js/my/notify.js"></script>-->
    <script src="../../js/app/utils.js"></script>
    <!--<script src="../../components/pinch-zoom-js/dist/underscore.js"></script>-->
    <!--<script src="../../components/pinch-zoom-js/dist/pinch-zoom.js"></script>-->
    <script>
        var historyLen = history.length-1;
        function back() {
            if (window.android){
                location.href = '/app/home';
            } else {
                window.history.go(-(history.length-historyLen));     // 站点列表页认为是history的第一个记录
            }
        }

        window.addEventListener('message', function(e) {
            var frames = window.frames;
            for(var i=0; i<frames.length; i++) {
                frames[i].postMessage('Bearer' + (getStorageItem('accountToken') || ''), '*');
            }
        }, false);
        var url = location.search.substring(location.search.lastIndexOf('http://'));
        url += "&mobile=1";
        window.onload = function () {
            var iframe = document.getElementById('iframe');
            iframe.src = url;
//            $.notify.progressStart();
            if (!/*@cc_on!@*/0) { //if not IE
                iframe.onload = function(){
                    iframe.onload = null;
//                    $.notify.progressStop();
                    enableZoom();
                };
            } else {
                iframe.onreadystatechange = function(){
                    if (iframe.readyState === "complete"){
//                        $.notify.progressStop();
                        enableZoom();
                    }
                };
            }
        };


        function enableZoom() {
            //new RTP.PinchZoom($("#targetObj"), {});
        }

    </script>
</body>
</html>